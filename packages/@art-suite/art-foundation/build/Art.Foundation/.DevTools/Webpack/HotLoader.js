// Generated by CoffeeScript 1.12.7
(function() {
  var BaseObject, HotLoader, log, peek, ref,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  ref = require("art-foundation"), BaseObject = ref.BaseObject, peek = ref.peek, log = ref.log;


  /*
  SBD NOTE 2021/8/11:
    This is clearly a duplicate with the ArtClassSystem.WebpackHotLoader
    mixin, but they are different enough that I'm not sure which one is "best."
  
    The last-alter dates were also very close:
    ArtFoundaiton's:
      commit d8b89ce35c7e4317a56e759cfd2eef5bef7cad3b
      Author: Shane Brinkman-Davis Delamore <shanebdavis@gmail.com>
      Date:   Sat Jul 1 19:50:06 2017 -0700
  
    ArtClassSystem's:
      commit 878805ccd69991995e0da0115416cd9d8ea63039
      Author: Shane Brinkman-Davis Delamore <shanebdavis@gmail.com>
      Date:   Sat Jul 1 11:35:25 2017 -0700
   */

  module.exports = HotLoader = (function(superClass) {
    extend(HotLoader, superClass);

    HotLoader.singletonClass();

    HotLoader.runHot = function(m, f) {
      return HotLoader.singleton.runHot(m, f);
    };

    HotLoader.getModuleState = function() {
      return peek(HotLoader.singleton._modulePersistantState);
    };

    function HotLoader() {
      this._modulePersistantState = [];
    }

    HotLoader.prototype.runHot = function(_module, f) {
      var base, res;
      if (_module != null ? _module.hot : void 0) {
        this._modulePersistantState.push(((base = _module.hot).data || (base.data = {
          modulePersistantState: {}
        })).modulePersistantState);
        _module.hot.accept();
        _module.hot.dispose(function(data) {
          return data.modulePersistantState = _module.hot.data.modulePersistantState;
        });
      }
      res = f(peek(this._modulePersistantState));
      if (_module != null ? _module.hot : void 0) {
        this._modulePersistantState.pop();
      }
      return res;
    };

    return HotLoader;

  })(BaseObject);

}).call(this);

//# sourceMappingURL=HotLoader.js.map
