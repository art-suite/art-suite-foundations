import &StandardImport

suite:
  maxLength: ->
    test "maxLength" ->
      v = new Validator id:
        fieldType: 'trimmedString'
        maxLength: 5
      assert.rejects v.preCreate id: "  too long man"

    test "maxLength is after preprocess" ->
      v = new Validator id:
        fieldType: 'trimmedString'
        maxLength: 5
      v.preCreate id: "   123   "
      .then ({id}) ->
        assert.eq id, "123"

  minLength: ->
    test "minLength" ->
      v = new Validator id:
        fieldType: 'trimmedString'
        minLength: 5
      assert.rejects v.preCreate id: "shrt"
      .then ->
        v.preCreate id: "long enough"

    test "minLength is after preprocess" ->
      v = new Validator id:
        fieldType: 'trimmedString'
        minLength: 5
      assert.rejects v.preCreate id: "   123   "

  both: ->
    test "minLength and maxLength" ->
      v = new Validator id:
        fieldType: 'trimmedString'
        minLength: 5
        maxLength: 10
      assert.rejects v.preCreate id: "1234"
      .then -> assert.rejects v.preCreate id: "1234567890-"
      .then ->
        v.preCreate id: "12345"
        v.preCreate id: "1234567890"
